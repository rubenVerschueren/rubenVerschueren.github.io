<!-- build time:Sat Mar 25 2017 11:26:13 GMT+0100 (Romance Standard Time) --><!DOCTYPE HTML><html><head><meta charset="utf-8"><title>upgrade-sitecore 6.5 to 8.2 - part 3 | Sitecorn</title><meta name="author" content="Ruben Verschueren"><meta name="description" content="upgrade part 3"><meta name="og:description" content="upgrade part 3"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:title" content="upgrade-sitecore 6.5 to 8.2 - part 3"><meta property="og:site_name" content="Sitecorn"><meta property="og:url" content="http://www.sitecorn.be/2017/03/17/upgrade-sitecore-6-5-to-8-2-part-3/"><meta property="og:image" content="http://www.sitecorn.be/images/sitecorn_large.png"><meta property="og:image:width" content="100"><meta property="og:image:height" content="121"><link rel="icon" type="image/png" href="http://www.sitecorn.be/images/fav.ico"><link href="http://www.sitecorn.be/images/sitecorn_large.png" rel="icon"><link rel="alternate" href="/atom.xml" title="Sitecorn" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"><link rel="stylesheet" href="/css/custom.css" media="screen" type="text/css"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-76954315-1","auto"),ga("send","pageview")</script></head></html><body><header id="header" class="inner"><div class="alignleft"><h1><a href="/">Sitecorn</a></h1><h2><a href="/">offering a few kernels of knowledge</a></h2></div><nav id="main-nav" class="alignright"><ul><li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li><li><a href="/about">About</a></li></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div id="content" class="inner"><div id="main-col" class="alignleft"><div id="wrapper"><article class="post"><div class="post-content"><header><div class="icon"></div><time datetime="2017-03-17T09:11:50.413Z"><a href="/2017/03/17/upgrade-sitecore-6-5-to-8-2-part-3/">2017-03-17</a></time><h1 class="title">upgrade-sitecore 6.5 to 8.2 - part 3</h1></header><div class="entry"><blockquote><p>Reality check</p></blockquote><p>In <a href="http://www.sitecorn.be/2016/10/19/upgrade-sitecore-6-5-to-8-2-part-2/">part 2</a> I talked about manually upgrading 6.5 to 7.2 and then using the Express Migration Tool, to take it to 8.2. Fortunately, by the time I got started, 6.6 was already supported by EMT.</p><p>Here are the high level steps I took to get to 8.2:</p><ul><li>Made backup of site and databases</li><li>Updated config files to 6.6 in VS solution</li><li>Updated dll references in solution to new sitecore dll versions</li><li>Updated dll references to 3rd party modules</li><li>Referenced new version of HTMLAgilityPack</li></ul><p>The third step was the most annoying here. I had to download the source code of the modules, replace the sitecore references and recompile. Most of them worked with minor tweaking here and there, so I could add them back into my VS solution. The project also heavily relied on 3rd party implementations of the company that originally developed the solution. This included (but was certainly not limited to) a custom buckets setup that didn’t really work well on a split CM and CD setup. I removed all of the references to their dll’s and started commenting out code until my project would build.</p><p>After this was done I was finally running on Sitecore 6.6 with a semi-disabled custom solution. Time for the EMT to do it’s thing…. and it did. after a few hours my site was upgraded to Sitecore 8.2. This meant it was once again time to update my sitecore references, comment out or modify code specific to 6.6 and get my VS solution to build again.</p><p>Once that was done I had a running 8.2 solution and a very ugly website with very few functionality. Time to bucle down and deep dive into the code, fixing commented out code and rewriting parts that were bugging me.</p><p>Deciding what to keep, what to change and what to throw out and rebuild is the biggest challenge in a project like this. Unfortunately I can’t give you any clear answers here but I would suggest to change only what’s needed.</p><p>I started with adding code generation for templates and a few item locations because I did not want to keep updating the existing POCO classes and “FieldInfo” classes. Hard coded strings give me nightmares, so I’ll let TDS worry about that and generate some code for me. After that I changed the way the 3rd party had implemented repositories (aka Search), configuration (which are items with a ton of fields) and dictionary (again custom).</p><p>Since this is now an 8.2 I thought I’d get on board with Helix and made these parts as foundations and/or features. Now if you’re reading this, you’re in the same boat as me so don’t do what I did next. I made a nice foundation for the base functionality of the repositories and started to move the concrete ones into helix features.</p><p>Turns out these existing repositories liked to keep their POCO classes close and the FieldInfo classes and they like their own POCO’s and FieldInfo’s and … You can guess the rest. after a few days of messing about, I had around 40 foundations with a lot of references between them. It may not be the best setup, but at least it provides a better view on what is in this project.</p><p><strong>A note on templates</strong></p><p>A problem that seems to occur with sitecore upgrades is the template inheritance tab being broken. There is usually a YSOD pointing to the fieldtype.</p><div class="figure"><img src="/images/TemplateInheritanceBug.png" title="Template Inheritance bug"></div><p>The easiest albeit time consuming method of fixing this is opening the template that has the bug (since not all of them may be affected). Switch on Raw Values and copy the contents of the base templates field to your favourite text editor.</p><div class="figure"><img src="/images/RawValuesSelected.png" title="View Raw values"></div><div class="figure"><img src="/images/StandardTemplateBasetemplates.png" title="standard template base templates"></div><p>I’m sure you can guess where this is going, open the templates belonging to these templates and set field types for those fields that have none selected. When you’ve gone through all of them the error should be gone. In my case there were some field sections on the standard template that were causing the issue. The following fields had no field type:</p><ul><li>Appearance section : **_Preview** field</li><li>Layout section : **_Controller** field</li><li>Tasks : **_Archive Version date** field</li></ul><p>In case this didn’t fix your problem there was an old bug in the sitecore 6-ish versions. In that case it was the _Owner field. Switch to the <strong>core</strong> database. open your content editor and select /sitecore/templates/System/Templates/Sections/Security Finally assign a “Single-Line Text” field type to the __Owner field. And that’s the end of that YSOD.</p></div><footer><div class="tags"><a href="/tags/sitecore/">sitecore</a>, <a href="/tags/upgrade/">upgrade</a>, <a href="/tags/migrate/">migrate</a>, <a href="/tags/fieldtype-error/">fieldtype error</a>, <a href="/tags/template-inheritance/">template inheritance</a></div><div class="addthis addthis_toolbox addthis_default_style"><a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> <a class="addthis_button_tweet"></a> <a class="addthis_button_google_plusone" g:plusone:size="medium"></a> <a class="addthis_counter addthis_pill_style"></a></div><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script><div class="clearfix"></div></footer></div></article><section id="comment"><h1 class="title">Comments</h1><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></div></div><aside id="sidebar" class="alignright"><a href="https://twitter.com/RubenVerschuern" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @RubenVerschuern</a><script>!function(t,e,r){var n,s=t.getElementsByTagName(e)[0],i=/^http:/.test(t.location)?"http":"https";t.getElementById(r)||(n=t.createElement(e),n.id=r,n.src=i+"://platform.twitter.com/widgets.js",s.parentNode.insertBefore(n,s))}(document,"script","twitter-wjs")</script><div class="widget tag"><h3 class="title">Tags</h3><ul class="entry"><li><a href="/tags/wffm-8-2/">WFFM 8.2</a><small>1</small></li><li><a href="/tags/adyen-skin/">adyen skin</a><small>1</small></li><li><a href="/tags/autocomplete/">autocomplete</a><small>1</small></li><li><a href="/tags/blog/">blog</a><small>1</small></li><li><a href="/tags/browser-extensions/">browser extensions</a><small>1</small></li><li><a href="/tags/bug/">bug</a><small>1</small></li><li><a href="/tags/cheat-sheet/">cheat sheet</a><small>1</small></li><li><a href="/tags/extension-methods/">extension methods</a><small>1</small></li><li><a href="/tags/fieldtype-error/">fieldtype error</a><small>1</small></li><li><a href="/tags/filter/">filter</a><small>1</small></li><li><a href="/tags/google-maps/">google maps</a><small>1</small></li><li><a href="/tags/hpp/">hpp</a><small>1</small></li><li><a href="/tags/itemlink/">itemlink</a><small>1</small></li><li><a href="/tags/javascript/">javascript</a><small>2</small></li><li><a href="/tags/maintenance/">maintenance</a><small>1</small></li><li><a href="/tags/markdown/">markdown</a><small>1</small></li><li><a href="/tags/mediarequest/">mediarequest</a><small>1</small></li><li><a href="/tags/migrate/">migrate</a><small>4</small></li><li><a href="/tags/multiple-renderings/">multiple renderings</a><small>1</small></li><li><a href="/tags/mvc/">mvc</a><small>1</small></li><li><a href="/tags/pdf/">pdf</a><small>1</small></li><li><a href="/tags/plugins/">plugins</a><small>1</small></li><li><a href="/tags/resharper/">resharper</a><small>1</small></li><li><a href="/tags/shortcut/">shortcut</a><small>1</small></li><li><a href="/tags/sitecore/">sitecore</a><small>5</small></li><li><a href="/tags/sitecore-8/">sitecore 8</a><small>4</small></li><li><a href="/tags/sql/">sql</a><small>3</small></li><li><a href="/tags/sql-server/">sql server</a><small>1</small></li><li><a href="/tags/t-sql/">t-sql</a><small>1</small></li><li><a href="/tags/template-inheritance/">template inheritance</a><small>1</small></li><li><a href="/tags/tools/">tools</a><small>1</small></li><li><a href="/tags/ucommerce/">ucommerce</a><small>3</small></li><li><a href="/tags/unit-testing/">unit testing</a><small>1</small></li><li><a href="/tags/upgrade/">upgrade</a><small>4</small></li><li><a href="/tags/visual-studio/">visual studio</a><small>1</small></li></ul></div></aside><div class="clearfix"></div></div><footer id="footer" class="inner"><div class="alignleft">&copy; 2017 Ruben Verschueren</div><div class="clearfix"></div></footer><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script><script type="text/javascript">var disqus_shortname="sitecorn";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript">!function(n){n(".fancybox").fancybox()}(jQuery)</script></body><!-- rebuild by neat -->