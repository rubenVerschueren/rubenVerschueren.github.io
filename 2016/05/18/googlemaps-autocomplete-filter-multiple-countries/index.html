<!-- build time:Fri Mar 24 2017 15:33:30 GMT+0100 (Romance Standard Time) --><!DOCTYPE HTML><html><head><meta charset="utf-8"><title>Google maps autocomplete filter by multiple countries | Sitecorn</title><meta name="author" content="Ruben Verschueren"><meta name="description" content="how to fiter a google maps autocomplete by multiple countries"><meta name="og:description" content="how to fiter a google maps autocomplete by multiple countries"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:title" content="Google maps autocomplete filter by multiple countries"><meta property="og:site_name" content="Sitecorn"><meta property="og:url" content="http://www.sitecorn.be/2016/05/18/googlemaps-autocomplete-filter-multiple-countries/"><meta property="og:image" content="http://www.sitecorn.be/images/sitecorn_large.png"><meta property="og:image:width" content="100"><meta property="og:image:height" content="121"><link rel="icon" type="image/png" href="http://www.sitecorn.be/images/fav.ico"><link href="http://www.sitecorn.be/images/sitecorn_large.png" rel="icon"><link rel="alternate" href="/atom.xml" title="Sitecorn" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"><link rel="stylesheet" href="/css/custom.css" media="screen" type="text/css"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-76954315-1","auto"),ga("send","pageview")</script></head></html><body><header id="header" class="inner"><div class="alignleft"><h1><a href="/">Sitecorn</a></h1><h2><a href="/">offering a few kernels of knowledge</a></h2></div><nav id="main-nav" class="alignright"><ul><li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li><li><a href="/about">About</a></li></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div id="content" class="inner"><div id="main-col" class="alignleft"><div id="wrapper"><article class="post"><div class="post-content"><header><div class="icon"></div><time datetime="2016-05-18T13:43:26.473Z"><a href="/2016/05/18/googlemaps-autocomplete-filter-multiple-countries/">2016-05-18</a></time><h1 class="title">Google maps autocomplete filter by multiple countries</h1></header><div class="entry"><p>At the end of last year (2014) I had to modify an existing Google maps autocomplete to filter by multiple countries. To my horror I discovered this was not possible, in fact the issue / feature request has been logged since 2012 (google issue) without any real fix. So I had to work around it.</p><p>I found out it is possible to get Autocomplete predictions, but sadly they suffer from the same shortcoming. However the predictions return a list of, well predictions allowing the developer to make their own lists. So that’s what I did and after sprinkling some jQuery around I came up with my own custom Autocomplete.</p><p>I only had to search a secondary country (Luxemburg) when the current country was Belgium, that’s why those countries are hard coded in the demo example. Feel free to use the code and change it in any way.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Retrieving Autocomplete Predictions&lt;/title&gt;</span><br><span class="line">    &lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"jquery.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"https://maps.googleapis.com/maps/api/js?libraries=places&amp;v=3.exp"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line"></span><br><span class="line">    <span class="function">function <span class="title">initialize</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">       $(<span class="string">"#place"</span>).live(<span class="string">"keyup"</span>, function (evt) &#123;           </span><br><span class="line">            <span class="comment">// Clear any previously set timer before setting a new one</span></span><br><span class="line">            window.clearTimeout($(<span class="keyword">this</span>).data(<span class="string">"timeout"</span>));</span><br><span class="line">            $(<span class="keyword">this</span>).data(<span class="string">"timeout"</span>, setTimeout(function () &#123;</span><br><span class="line">                <span class="comment">//whe the timeout has expired get the predictions</span></span><br><span class="line">                <span class="keyword">var</span> inputData = $(<span class="string">"#place"</span>).val();          </span><br><span class="line">                service = <span class="keyword">new</span> google.maps.places.AutocompleteService();</span><br><span class="line">                <span class="keyword">var</span> request = &#123;</span><br><span class="line">                    input: inputData,</span><br><span class="line">                    componentRestrictions: &#123;country: <span class="string">'be'</span>&#125;,</span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="keyword">var</span> secondaryRequest = &#123;</span><br><span class="line">                    input: inputData,</span><br><span class="line">                    componentRestrictions: &#123;country: <span class="string">'lu'</span>&#125;,</span><br><span class="line">                &#125;;</span><br><span class="line">                $(<span class="string">'#resultWindow'</span>).empty();</span><br><span class="line">                service.getPlacePredictions(request, callback);</span><br><span class="line">                service.getPlacePredictions(secondaryRequest, callback);            </span><br><span class="line">            &#125;, <span class="number">1000</span>));</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="function">function <span class="title">callback</span>(<span class="params">predictions, status</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (status != google.maps.places.PlacesServiceStatus.OK) &#123;</span><br><span class="line">                console.log(status);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;    </span><br><span class="line">            <span class="keyword">var</span> resultHTML = <span class="string">''</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, prediction; prediction = predictions[i]; i++) &#123;</span><br><span class="line">                resultHTML += <span class="string">'&lt;div&gt;'</span> + prediction.description + <span class="string">'&lt;/div&gt;'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>($(<span class="string">'#resultWindow'</span>).html() != undefined &amp;&amp; $(<span class="string">'#resultWindow'</span>).html() != <span class="string">''</span>)&#123;      </span><br><span class="line">                resultHTML = $(<span class="string">'#resultWindow'</span>).html()+ resultHTML;</span><br><span class="line">            &#125;       </span><br><span class="line">            <span class="keyword">if</span>(resultHTML != undefined &amp;&amp; resultHTML != <span class="string">''</span>)&#123;        </span><br><span class="line">                $(<span class="string">'#resultWindow'</span>).html(resultHTML).show();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//add the "powered by google" image at the bottom -&gt; required!!</span></span><br><span class="line">            <span class="keyword">if</span>($(<span class="string">'#resultWindow'</span>).html() != undefined)&#123;</span><br><span class="line">                $(<span class="string">'#resultWindow #googleImage'</span>).remove();</span><br><span class="line">                <span class="keyword">var</span> imageHtml = $(<span class="string">'#resultWindow'</span>).html() </span><br><span class="line">				+ <span class="string">'&lt;img id="googleImage" src="powered-by-google-on-white2.png"/&gt;'</span>;</span><br><span class="line">                $(<span class="string">'#resultWindow'</span>).html(imageHtml);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function">function <span class="title">geocodeAddress</span>(<span class="params">address</span>) </span>&#123;      </span><br><span class="line">            <span class="keyword">var</span> geocoder = <span class="keyword">new</span> google.maps.Geocoder();      </span><br><span class="line">            geocoder.geocode(&#123;<span class="string">'address'</span>: address&#125;, function (results, status) </span><br><span class="line">            &#123;   </span><br><span class="line">              <span class="keyword">if</span> (status == google.maps.GeocoderStatus.OK) </span><br><span class="line">              &#123;</span><br><span class="line">                $(<span class="string">'#latitude'</span>).val(results[<span class="number">0</span>].geometry.location.lat());</span><br><span class="line">                $(<span class="string">'#longitude'</span>).val(results[<span class="number">0</span>].geometry.location.lng());        </span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span> &#123;</span><br><span class="line">                console.log(<span class="string">"Error: "</span> + google.maps.GeocoderStatus);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        $(<span class="string">'#resultWindow div'</span>).live(<span class="string">'click'</span>,function()&#123;</span><br><span class="line">            <span class="comment">//get the coördinates for the selected (clicked) address</span></span><br><span class="line">            $(<span class="string">'#resultWindow'</span>).hide();</span><br><span class="line">            <span class="keyword">var</span> address = $(<span class="keyword">this</span>).text();</span><br><span class="line">            <span class="keyword">var</span> addressParts = address.split(<span class="string">','</span>);</span><br><span class="line">            $(<span class="string">'#country'</span>).val(addressParts[<span class="number">2</span>]);</span><br><span class="line">            $(<span class="string">'#city'</span>).val(addressParts[<span class="number">1</span>]);</span><br><span class="line">            $(<span class="string">'#place'</span>).val(addressParts[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">if</span>(address != <span class="string">''</span>)&#123;</span><br><span class="line">                geocodeAddress(address);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      <span class="comment">/*end custom autocomplete stuff*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    google.maps.<span class="keyword">event</span>.addDomListener(window, <span class="string">'load'</span>, initialize);</span><br><span class="line"></span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line">    <span class="meta">#resultWindow&#123;  </span></span><br><span class="line">        position: <span class="keyword">fixed</span>;</span><br><span class="line">       <span class="comment">/* top: 0;</span><br><span class="line">        left: 0;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;*/</span></span><br><span class="line">        background-color: <span class="meta">#fff;</span></span><br><span class="line">        filter:alpha(opacity=<span class="number">50</span>);</span><br><span class="line">        -moz-opacity:<span class="number">0.5</span>;</span><br><span class="line">        -khtml-opacity: <span class="number">0.5</span>;</span><br><span class="line">        opacity: <span class="number">0.5</span>;</span><br><span class="line">        z-index: <span class="number">10000</span>;</span><br><span class="line">        border: <span class="number">1</span>px solid black;</span><br><span class="line">        color:black;</span><br><span class="line">        display:none;</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=<span class="string">"placeholder"</span>&gt;  </span><br><span class="line">    &lt;input type=<span class="string">"text"</span> id=<span class="string">"place"</span> style=<span class="string">"width:200px;"</span>/&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"latitude"</span>&gt;Latitude&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">"text"</span> id=<span class="string">"latitude"</span>/&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"longitude"</span>&gt;Longitude&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">"text"</span> id=<span class="string">"longitude"</span>/&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"city"</span>&gt;city&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">"text"</span> id=<span class="string">"city"</span>/&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"country"</span>&gt;selected country&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">"text"</span> id=<span class="string">"country"</span>/&gt;</span><br><span class="line">    &lt;div id=<span class="string">"resultWindow"</span>&gt;&lt;/div&gt;   </span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></div><footer><div class="tags"><a href="/tags/google-maps/">google maps</a>, <a href="/tags/javascript/">javascript</a>, <a href="/tags/autocomplete/">autocomplete</a>, <a href="/tags/filter/">filter</a></div><div class="addthis addthis_toolbox addthis_default_style"><a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> <a class="addthis_button_tweet"></a> <a class="addthis_button_google_plusone" g:plusone:size="medium"></a> <a class="addthis_counter addthis_pill_style"></a></div><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script><div class="clearfix"></div></footer></div></article><section id="comment"><h1 class="title">Comments</h1><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></div></div><aside id="sidebar" class="alignright"><a href="https://twitter.com/RubenVerschuern" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @RubenVerschuern</a><script>!function(t,e,r){var n,s=t.getElementsByTagName(e)[0],i=/^http:/.test(t.location)?"http":"https";t.getElementById(r)||(n=t.createElement(e),n.id=r,n.src=i+"://platform.twitter.com/widgets.js",s.parentNode.insertBefore(n,s))}(document,"script","twitter-wjs")</script><div class="widget tag"><h3 class="title">Tags</h3><ul class="entry"><li><a href="/tags/adyen-skin/">adyen skin</a><small>1</small></li><li><a href="/tags/autocomplete/">autocomplete</a><small>1</small></li><li><a href="/tags/blog/">blog</a><small>1</small></li><li><a href="/tags/browser-extensions/">browser extensions</a><small>1</small></li><li><a href="/tags/cheat-sheet/">cheat sheet</a><small>1</small></li><li><a href="/tags/extension-methods/">extension methods</a><small>1</small></li><li><a href="/tags/fieldtype-error/">fieldtype error</a><small>1</small></li><li><a href="/tags/filter/">filter</a><small>1</small></li><li><a href="/tags/google-maps/">google maps</a><small>1</small></li><li><a href="/tags/hpp/">hpp</a><small>1</small></li><li><a href="/tags/itemlink/">itemlink</a><small>1</small></li><li><a href="/tags/javascript/">javascript</a><small>2</small></li><li><a href="/tags/maintenance/">maintenance</a><small>1</small></li><li><a href="/tags/markdown/">markdown</a><small>1</small></li><li><a href="/tags/mediarequest/">mediarequest</a><small>1</small></li><li><a href="/tags/migrate/">migrate</a><small>3</small></li><li><a href="/tags/multiple-renderings/">multiple renderings</a><small>1</small></li><li><a href="/tags/mvc/">mvc</a><small>1</small></li><li><a href="/tags/pdf/">pdf</a><small>1</small></li><li><a href="/tags/plugins/">plugins</a><small>1</small></li><li><a href="/tags/resharper/">resharper</a><small>1</small></li><li><a href="/tags/shortcut/">shortcut</a><small>1</small></li><li><a href="/tags/sitecore/">sitecore</a><small>4</small></li><li><a href="/tags/sitecore-8/">sitecore 8</a><small>4</small></li><li><a href="/tags/sql/">sql</a><small>3</small></li><li><a href="/tags/sql-server/">sql server</a><small>1</small></li><li><a href="/tags/t-sql/">t-sql</a><small>1</small></li><li><a href="/tags/template-inheritance/">template inheritance</a><small>1</small></li><li><a href="/tags/tools/">tools</a><small>1</small></li><li><a href="/tags/ucommerce/">ucommerce</a><small>3</small></li><li><a href="/tags/unit-testing/">unit testing</a><small>1</small></li><li><a href="/tags/upgrade/">upgrade</a><small>3</small></li><li><a href="/tags/visual-studio/">visual studio</a><small>1</small></li></ul></div></aside><div class="clearfix"></div></div><footer id="footer" class="inner"><div class="alignleft">&copy; 2017 Ruben Verschueren</div><div class="clearfix"></div></footer><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script><script type="text/javascript">var disqus_shortname="sitecorn";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript">!function(n){n(".fancybox").fancybox()}(jQuery)</script></body><!-- rebuild by neat -->