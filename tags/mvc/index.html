<!-- build time:Thu Sep 08 2016 15:50:37 GMT+0200 (Romance Daylight Time) --><!DOCTYPE HTML><html><head><meta charset="utf-8"><title>mvc | Sitecorn</title><meta name="author" content="Ruben Verschueren"><meta name="description" content="web development tips &amp; tricks"><meta name="og:description" content="web development tips &amp; tricks"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:site_name" content="Sitecorn"><meta property="og:url" content="http://www.sitecorn.be/tags/mvc/index.html"><meta property="og:image" content="http://www.sitecorn.be/images/sitecorn_large.png"><meta property="og:image:width" content="100"><meta property="og:image:height" content="121"><link rel="icon" type="image/png" href="http://www.sitecorn.be/images/fav.ico"><link href="http://www.sitecorn.be/images/sitecorn_large.png" rel="icon"><link rel="alternate" href="/atom.xml" title="Sitecorn" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"><link rel="stylesheet" href="/css/custom.css" media="screen" type="text/css"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-76954315-1","auto"),ga("send","pageview")</script></head></html><body><header id="header" class="inner"><div class="alignleft"><h1><a href="/">Sitecorn</a></h1><h2><a href="/">offering a few kernels of knowledge</a></h2></div><nav id="main-nav" class="alignright"><ul><li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li><li><a href="/about">About</a></li></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div id="content" class="inner"><div id="main-col" class="alignleft"><div id="wrapper"><h2 class="archive-title tag">mvc</h2><div class="archive"><article class="post"><div class="post-content"><header><div class="icon"></div><time datetime="2016-05-18T10:57:42.746Z"><a href="/2016/05/18/mvc/sitecore-multiple-forms-on-a-page/">2016-05-18</a></time><h1 class="title"><a href="/2016/05/18/mvc/sitecore-multiple-forms-on-a-page/">Sitecore multiple forms on one page - view renderings</a></h1></header><div class="entry"><p>I was trying to read out form values after a POST and was reminded by a colleague that all controller actions will be able to render the form. That simply will not do. He referred me to some excellent blog posts which offer a solution for the controller renderings. Check out Reinoud Van Dalen's ultimate fix for multiple forms on one page with sitecore mvc</p><p>However I happened to have a view rendering on the receiving end of the form post. This blog post will explain how you can apply the same principle to view rendering.</p><h3>Create a sitecoreHelperExtension</h3><p>This code was copied form Reinoud's solution, with a small modification to allow the developer to choose his own id (in case you want to use the id from some kind of generated code)</p><p></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MvcHtmlString <span class="title">RenderingToken</span>(<span class="params"><span class="keyword">this</span> SitecoreHelper helper, <span class="keyword">string</span> id = <span class="keyword">null</span></span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (helper.CurrentRendering == <span class="keyword">null</span>)</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> tagBuilder = <span class="keyword">new</span> TagBuilder(<span class="string">"input"</span>);</span><br><span class="line">   tagBuilder.Attributes[<span class="string">"type"</span>] = <span class="string">"hidden"</span>;</span><br><span class="line">   tagBuilder.Attributes[<span class="string">"name"</span>] = <span class="string">"uid"</span>;</span><br><span class="line">   tagBuilder.Attributes[<span class="string">"value"</span>] = id ?? helper.CurrentRendering.UniqueId.ToString();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> MvcHtmlString(tagBuilder.ToString(TagRenderMode.SelfClosing));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3>Update your form</h3><p>You can call this without a parameter and it will use the id of the current rendering (default).</p><p></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Html.Sitecore().RenderingToken()</span><br></pre></td></tr></table></figure><p></p><p>Alternatively you could call it using a custom Id, in this case the item Id from our generated code</p><p></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Html.Sitecore().RenderingToken(ItemTree.Layout.Renderings.MyRendering.ItemID.ToGuid().ToString())</span><br></pre></td></tr></table></figure><p></p><p>This will generate a hidden field with the unique id of the current rendering (or the ID of your choice). That value will then get posted with the rest of you form.</p><p><strong>remark</strong> the ToGuid() method will remove the curly braces. You can skip that if you don't mind them in you values. Just don't forget to use the same structure (with or without curly braces) when reading it back out.</p><h3>Creating a form Extension</h3><p>The first method checks for the correct source form. It does this by comparing the posted Id with the Id you provide it in the renderId parameter. The second method reads the form value in case the source is confirmed to be the correct form.</p><p></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">FormExtensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">IsSourceForm</span>(<span class="params"><span class="keyword">this</span> HttpRequestBase request, <span class="keyword">string</span> renderId, <span class="keyword">string</span> sourceField = <span class="keyword">null</span></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">string</span> sourceFieldName = sourceField ?? <span class="string">"uid"</span>;</span><br><span class="line">        <span class="keyword">return</span> request.Form != <span class="keyword">null</span> &amp;&amp; !request.Form[sourceFieldName].IsNullOrEmpty() &amp;&amp;</span><br><span class="line">                   request.Form[sourceFieldName].Equals(renderId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">GetFormSourceValue</span>(<span class="params"><span class="keyword">this</span> HttpRequestBase request, <span class="keyword">string</span> renderId,</span><br><span class="line"> 	<span class="keyword">string</span> formFieldName, <span class="keyword">string</span> sourceFieldName = <span class="keyword">null</span></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!IsSourceForm(request, renderId, sourceFieldName))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> request.Form[formFieldName].HasValue() </span><br><span class="line">			? request.Form[formFieldName] </span><br><span class="line">			: <span class="keyword">string</span>.Empty;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>Here's the one liner on how to get the value you want, from the form you want .</p><p></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formID = ItemTree.Layout.Renderings.MyRendering.ItemID.ToGuid().ToString();</span><br><span class="line"><span class="keyword">var</span> formValue = Request.GetFormSourceValue(formID, <span class="string">"name of form value"</span>);</span><br></pre></td></tr></table></figure><p></p></div></div></article></div></div></div><aside id="sidebar" class="alignright"><a href="https://twitter.com/RubenVerschuern" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @RubenVerschuern</a><script>!function(t,e,r){var n,s=t.getElementsByTagName(e)[0],i=/^http:/.test(t.location)?"http":"https";t.getElementById(r)||(n=t.createElement(e),n.id=r,n.src=i+"://platform.twitter.com/widgets.js",s.parentNode.insertBefore(n,s))}(document,"script","twitter-wjs")</script><div class="widget tag"><h3 class="title">Tags</h3><ul class="entry"><li><a href="/tags/adyen-skin/">adyen skin</a><small>1</small></li><li><a href="/tags/autocomplete/">autocomplete</a><small>1</small></li><li><a href="/tags/blog/">blog</a><small>1</small></li><li><a href="/tags/browser-extensions/">browser extensions</a><small>1</small></li><li><a href="/tags/cheat-sheet/">cheat sheet</a><small>1</small></li><li><a href="/tags/extension-methods/">extension methods</a><small>1</small></li><li><a href="/tags/filter/">filter</a><small>1</small></li><li><a href="/tags/google-maps/">google maps</a><small>1</small></li><li><a href="/tags/hpp/">hpp</a><small>1</small></li><li><a href="/tags/itemlink/">itemlink</a><small>1</small></li><li><a href="/tags/javascript/">javascript</a><small>2</small></li><li><a href="/tags/markdown/">markdown</a><small>1</small></li><li><a href="/tags/mediarequest/">mediarequest</a><small>1</small></li><li><a href="/tags/multiple-renderings/">multiple renderings</a><small>1</small></li><li><a href="/tags/mvc/">mvc</a><small>1</small></li><li><a href="/tags/pdf/">pdf</a><small>1</small></li><li><a href="/tags/plugins/">plugins</a><small>1</small></li><li><a href="/tags/resharper/">resharper</a><small>1</small></li><li><a href="/tags/shortcut/">shortcut</a><small>1</small></li><li><a href="/tags/sitecore-8/">sitecore 8</a><small>4</small></li><li><a href="/tags/sql/">sql</a><small>3</small></li><li><a href="/tags/tools/">tools</a><small>1</small></li><li><a href="/tags/ucommerce/">ucommerce</a><small>3</small></li><li><a href="/tags/unit-testing/">unit testing</a><small>1</small></li><li><a href="/tags/visual-studio/">visual studio</a><small>1</small></li></ul></div></aside><div class="clearfix"></div></div><footer id="footer" class="inner"><div class="alignleft">&copy; 2016 Ruben Verschueren</div><div class="clearfix"></div></footer><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script><script type="text/javascript">var disqus_shortname="sitecorn";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/count.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript">!function(n){n(".fancybox").fancybox()}(jQuery)</script></body><!-- rebuild by neat -->